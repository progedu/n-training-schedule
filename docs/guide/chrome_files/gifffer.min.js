!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Gifffer",[],e):"object"==typeof exports?exports.Gifffer=e():t.Gifffer=e()}(this,function(){function t(t){var e="";for(prop in t)e+=prop+":"+t[prop]+";";return e}function e(e,i,r,d,a){var l,p=n.createElement("BUTTON"),s=r.getAttribute("class"),u=r.getAttribute("id"),f=a&&a.playButtonStyles?t(a.playButtonStyles):["width:"+o+"px","height:"+o+"px","border-radius:"+o/2+"px","background:rgba(0, 0, 0, 0.3)","position:absolute","top:50%","left:50%","margin:-"+o/2+"px"].join(";"),h=a&&a.playButtonIconStyles?t(a.playButtonIconStyles):["width: 0","height: 0","border-top: 14px solid transparent","border-bottom: 14px solid transparent","border-left: 14px solid rgba(0, 0, 0, 0.5)","position: absolute","left: 26px","top: 16px"].join(";");s?p.setAttribute("class",r.getAttribute("class")):null,u?p.setAttribute("id",r.getAttribute("id")):null,p.setAttribute("style","position:relative;cursor:pointer;background:none;border:none;padding:0;"),p.setAttribute("aria-hidden","true");var g=n.createElement("DIV");g.setAttribute("class","gifffer-play-button"),g.setAttribute("style",f);var c=n.createElement("DIV");return c.setAttribute("style",h),g.appendChild(c),d&&(l=n.createElement("p"),l.setAttribute("class","gifffer-alt"),l.setAttribute("style","border:0;clip:rect(0 0 0 0);height:1px;overflow:hidden;padding:0;position:absolute;width:1px;"),l.innerText=d+", image"),p.appendChild(g),r.parentNode.replaceChild(p,r),d?p.parentNode.insertBefore(l,p.nextSibling):null,{c:p,p:g}}function i(t,e,i,r,n){var o=t.parentNode.offsetWidth,d=(t.parentNode.offsetHeight,r/n);return e.toString().indexOf("%")>0?(e=parseInt(e.toString().replace("%","")),e=e/100*o,i=e/d):i.toString().indexOf("%")>0&&(i=parseInt(i.toString().replace("%","")),i=i/100*o,e=i*d),{w:e,h:i}}function r(t,r,n){var o,d,a,l,p,s,u,f,h,g,c,b,y,x=!1;o=t.getAttribute("src"),l=t.getAttribute("data-gifffer-width"),p=t.getAttribute("data-gifffer-height"),s=t.getAttribute("data-gifffer-duration"),y=t.getAttribute("data-gifffer-alt"),t.style.display="block",a=document.createElement("canvas"),g=!(!a.getContext||!a.getContext("2d")),l&&p&&g&&(h=e(l,p,t,y,n)),t.onload=function(){g&&(l=l||t.width,p=p||t.height,h||(h=e(l,p,t,y,n)),d=h.c,u=h.p,b=i(d,l,p,t.width,t.height),r.push(d),d.addEventListener("click",function(){clearTimeout(c),x?(x=!1,d.appendChild(u),d.removeChild(f),d.appendChild(a),f=null):(x=!0,f=document.createElement("IMG"),f.setAttribute("style","width:100%;height:100%;"),f.setAttribute("data-uri",Math.floor(1e5*Math.random())+1),setTimeout(function(){f.src=o},0),d.removeChild(u),d.removeChild(a),d.appendChild(f),parseInt(s)>0&&(c=setTimeout(function(){x=!1,d.appendChild(u),d.removeChild(f),d.appendChild(a),f=null},s)))}),a.width=b.w,a.height=b.h,a.getContext("2d").drawImage(t,0,0,b.w,b.h),d.appendChild(a),d.setAttribute("style","position:relative;cursor:pointer;width:"+b.w+"px;height:"+b.h+"px;background:none;border:none;padding:0;"),a.style.width="100%",a.style.height="100%",l.toString().indexOf("%")>0&&p.toString().indexOf("%")>0?(d.style.width=l,d.style.height=p):l.toString().indexOf("%")>0?(d.style.width=l,d.style.height="inherit"):p.toString().indexOf("%")>0?(d.style.width="inherit",d.style.height=p):(d.style.width=b.w+"px",d.style.height=b.h+"px"))},t.src=o}if("undefined"!=typeof window&&"undefined"!=typeof document){var n=document,o=60,d=function(t){var e,i=0,o=[];for(e=n.querySelectorAll("div.data-gifffer > img");i<e.length;++i)r(e[i],o,t);return o};return d}});